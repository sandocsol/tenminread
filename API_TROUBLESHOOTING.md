# API 연동 문제 해결 가이드

## 404 에러 발생 시 확인 사항

### 1. 백엔드 서버 상태 확인

#### 백엔드 서버가 실행 중인지 확인
- [ ] 백엔드 서버가 실행 중인가?
- [ ] 백엔드 서버 포트가 올바른가? (기본값: 8080)
- [ ] 백엔드 서버 로그에 요청이 도달하는가?

#### 네트워크 연결 확인
- [ ] 백엔드 서버에 직접 접근 가능한가? (예: `http://localhost:8080`)
- [ ] CORS 설정이 올바른가?
- [ ] 방화벽이나 네트워크 설정 문제는 없는가?

### 2. 프론트엔드 설정 확인

#### 환경 변수 설정
```env
# .env 파일에 추가
VITE_API_BASE_URL=http://localhost:8080/api
# 또는 프록시 사용 시
VITE_PROXY_TARGET=http://localhost:8080
```

#### Vite 프록시 설정 확인 (`vite.config.js`)
- [ ] `target` 주소가 백엔드 서버 주소와 일치하는가?
- [ ] 개발 서버 재시작 후 적용되었는가?

### 3. API 엔드포인트 경로 확인

#### 현재 프론트엔드에서 사용하는 엔드포인트:
- `GET /api/book/{bookId}` - 책 정보 조회
- `GET /api/book/{bookId}/summary/{seq}` - 책 요약 조회
- `GET /api/book/{bookId}/index` - 책 목차 조회
- `GET /api/book/{bookId}/progress` - 독서 진행 상황 조회
- `POST /api/book/{bookId}/favorites` - 즐겨찾기 토글
- `GET /api/books/{bookId}/summary/{summaryId}/quizzes` - 퀴즈 조회
- `POST /api/books/{bookId}/summary/{summaryId}/submit` - 퀴즈 제출

#### 백엔드 API 문서와 비교:
- [ ] 엔드포인트 경로가 일치하는가?
- [ ] HTTP 메서드가 일치하는가? (GET, POST 등)
- [ ] 경로 파라미터 이름이 일치하는가? (bookId, seq, summaryId 등)

**주의**: `bookApi`는 `/book/` (단수), `quizApi`는 `/books/` (복수)를 사용하고 있습니다.
백엔드 API 문서를 확인하여 올바른 경로로 수정해야 할 수 있습니다.

### 4. 요청 파라미터 확인

#### 파라미터 타입 확인
- [ ] `bookId`가 문자열인가, 숫자인가?
- [ ] `seq`가 문자열인가, 숫자인가?
- [ ] 백엔드에서 기대하는 타입과 일치하는가?

#### 요청 본문 확인 (POST 요청)
- [ ] 요청 본문 형식이 올바른가?
- [ ] 필수 필드가 모두 포함되어 있는가?

### 5. 인증/인가 확인

#### 인증 토큰 필요 여부
- [ ] API 호출에 인증 토큰이 필요한가?
- [ ] axios 인터셉터로 토큰을 추가해야 하는가?
- [ ] 토큰이 만료되지 않았는가?

#### 헤더 확인
- [ ] Content-Type이 올바른가?
- [ ] 다른 커스텀 헤더가 필요한가?

### 6. 백엔드 응답 확인

#### 에러 응답 형식
백엔드가 반환하는 에러 응답 형식을 확인:
```javascript
// 예시: 백엔드 에러 응답 형식
{
  "error": "Not Found",
  "message": "책을 찾을 수 없습니다",
  "status": 404
}
```

#### 성공 응답 형식
백엔드가 반환하는 성공 응답 형식을 확인:
- [ ] 응답 데이터 구조가 예상과 일치하는가?
- [ ] 필드 이름이 일치하는가?

## 디버깅 방법

### 1. 브라우저 개발자 도구 확인

#### Network 탭
1. 개발자 도구 열기 (F12)
2. Network 탭 선택
3. API 호출 시도
4. 실패한 요청 클릭하여 확인:
   - Request URL: 실제 호출된 URL
   - Request Method: HTTP 메서드
   - Status Code: 응답 상태 코드
   - Response: 백엔드 응답 내용

#### Console 탭
- 에러 메시지 확인
- API 호출 로그 확인

### 2. 백엔드 로그 확인

백엔드 서버 로그에서 다음을 확인:
- [ ] 요청이 도달했는가?
- [ ] 어떤 엔드포인트로 요청이 들어왔는가?
- [ ] 파라미터가 올바르게 전달되었는가?
- [ ] 어떤 에러가 발생했는가?

### 3. 직접 API 테스트

#### Postman 또는 curl 사용
```bash
# 예시: 책 요약 조회 API 직접 테스트
curl -X GET http://localhost:8080/api/book/1/summary/1
```

## 일반적인 문제와 해결 방법

### 문제 1: 404 Not Found

**원인:**
- 엔드포인트 경로가 잘못됨
- 백엔드 서버가 실행되지 않음
- 프록시 설정이 잘못됨

**해결:**
1. 백엔드 API 문서와 경로 비교
2. 백엔드 서버 실행 확인
3. `vite.config.js` 프록시 설정 확인

### 문제 2: CORS 에러

**원인:**
- 백엔드 CORS 설정이 없음
- 프록시 설정이 없음

**해결:**
1. 개발 환경에서는 Vite 프록시 사용
2. 프로덕션 환경에서는 백엔드 CORS 설정 필요

### 문제 3: 401 Unauthorized

**원인:**
- 인증 토큰이 없음
- 토큰이 만료됨

**해결:**
1. 로그인하여 토큰 획득
2. axios 인터셉터로 토큰 추가

### 문제 4: 400 Bad Request

**원인:**
- 요청 본문 형식이 잘못됨
- 필수 파라미터가 누락됨
- 파라미터 타입이 잘못됨

**해결:**
1. 백엔드 API 문서와 요청 형식 비교
2. 파라미터 검증 추가

## 체크리스트

API 연동 전 다음을 확인하세요:

### 프론트엔드
- [ ] `API_BASE_URL`이 올바르게 설정되었는가?
- [ ] 엔드포인트 경로가 백엔드 문서와 일치하는가?
- [ ] HTTP 메서드가 올바른가? (GET, POST 등)
- [ ] 요청 파라미터가 올바른가?
- [ ] 요청 본문 형식이 올바른가?
- [ ] 인증 토큰이 필요한 경우 추가되었는가?
- [ ] Vite 프록시 설정이 올바른가?

### 백엔드
- [ ] 백엔드 서버가 실행 중인가?
- [ ] 엔드포인트가 구현되어 있는가?
- [ ] CORS 설정이 올바른가?
- [ ] 인증/인가가 올바르게 설정되어 있는가?
- [ ] 요청 형식을 올바르게 처리하는가?
- [ ] 응답 형식이 예상과 일치하는가?

